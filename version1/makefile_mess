CFLAGS += -Wall -g 
LDFLAGS +=  -lpthread -lpcap -lprotobuf-c -Wl,--no-undefined 
DEPS = person.pb-c.h information.pb-c.h syn.pb-c.h conn.h protoObject.h config.h connac_state.h connac_ac.h 
OBJ: main.o conn.o config.o connac_state.o connac_ac.o information.pb-c.o person.pb-c.o syn.pb-c.o protoObject.o
 
all: connac

connac: $(OBJ)
	gcc  -o $@ $^ $(CFLAGS) $(LDFLAGS)

#person.pb-c.o: person.pb-c.c 
#	gcc -c $(CFLAGS) $(LDFLAGS) person.pb-c.h person.pb-c.c

%.o: %.c $(DEPS)
	$(CC) -c $(CFLAGS) $(LDFLAGS) -o $@ $<


main.o: main.c 
	gcc -c $(CFLAGS) $(LDFLAGS) main.c

clean: 
	rm -rf main.o conn.o config.o protoObject.o connac_state.o
